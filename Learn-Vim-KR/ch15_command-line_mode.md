# Ch15. 커맨드-라인 모드

지난 세 장에서는 검색 명령어(`/`, `?`), 치환 명령어(`:s`), 전역 명령어(`:g`), 그리고 외부 명령어(`!`)를 사용하는 방법을 배웠습니다. 이것들은 커맨드-라인 모드 명령어의 예입니다.

이 장에서는 커맨드-라인 모드에 대한 다양한 팁과 트릭을 배웁니다.

## 커맨드-라인 모드 들어가고 나가기

커맨드-라인 모드는 일반 모드, 삽입 모드, 비주얼 모드와 마찬가지로 그 자체로 하나의 모드입니다. 이 모드에 있을 때, 커서는 화면 하단으로 이동하여 다른 명령어들을 입력할 수 있습니다.

커맨드-라인 모드로 들어가는 데 사용할 수 있는 4가지 다른 명령어가 있습니다:
- 검색 패턴 (`/`, `?`)
- 커맨드-라인 명령어 (`:`)
- 외부 명령어 (`!`)

일반 모드나 비주얼 모드에서 커맨드-라인 모드로 들어갈 수 있습니다.

커맨드-라인 모드를 나가려면 `<Esc>`, `Ctrl-C`, 또는 `Ctrl-[`를 사용할 수 있습니다.

*다른 문헌에서는 "커맨드-라인 명령어"를 "Ex 명령어"로, "외부 명령어"를 "필터 명령어" 또는 "뱅 연산자"로 지칭할 수 있습니다.*

## 이전 명령어 반복하기

`@:`로 이전 커맨드-라인 명령어 또는 외부 명령어를 반복할 수 있습니다.

방금 `:s/foo/bar/g`를 실행했다면, `@:`를 실행하면 해당 치환이 반복됩니다. 방금 `:.!tr '[a-z]' '[A-Z]'`를 실행했다면, `@:`를 실행하면 마지막 외부 명령어 번역 필터가 반복됩니다.

## 커맨드-라인 모드 단축키

커맨드-라인 모드에 있는 동안, `Left` 또는 `Right` 화살표로 한 번에 한 문자씩 왼쪽이나 오른쪽으로 이동할 수 있습니다.

단어 단위로 이동해야 하는 경우, `Shift-Left` 또는 `Shift-Right`를 사용하세요 (일부 OS에서는 `Shift` 대신 `Ctrl`을 사용해야 할 수도 있습니다).

줄의 시작으로 가려면 `Ctrl-B`를 사용하세요. 줄의 끝으로 가려면 `Ctrl-E`를 사용하세요.

삽입 모드와 유사하게, 커맨드-라인 모드 안에는 문자를 삭제하는 세 가지 방법이 있습니다:

```
Ctrl-H    한 문자 삭제
Ctrl-W    한 단어 삭제
Ctrl-U    전체 줄 삭제
```
마지막으로, 일반 텍스트 파일처럼 명령어를 편집하고 싶다면 `Ctrl-F`를 사용하세요.

이것은 또한 이전 명령어들을 검색하고, 편집하고, "커맨드-라인 편집 일반 모드"에서 `<Enter>`를 눌러 다시 실행할 수 있게 해줍니다.

## 레지스터와 자동 완성

커맨드-라인 모드에 있는 동안, 삽입 모드와 동일한 방식으로 `Ctrl-R`로 Vim 레지스터에서 텍스트를 삽입할 수 있습니다. a 레지스터에 "foo" 문자열이 저장되어 있다면, `Ctrl-R a`를 실행하여 삽입할 수 있습니다. 삽입 모드에서 레지스터로부터 얻을 수 있는 모든 것을, 커맨드-라인 모드에서도 동일하게 할 수 있습니다.

또한, 커서 아래의 단어는 `Ctrl-R Ctrl-W`로 (`Ctrl-R Ctrl-A`는 커서 아래의 WORD), 커서 아래의 줄은 `Ctrl-R Ctrl-L`로, 커서 아래의 파일 이름은 `Ctrl-R Ctrl-F`로 가져올 수 있습니다.

기존 명령어를 자동 완성할 수도 있습니다. `echo` 명령어를 자동 완성하려면, 커맨드-라인 모드에서 "ec"를 입력한 다음 `<Tab>`을 누르세요. 화면 왼쪽 하단에 "ec"로 시작하는 Vim 명령어들이 표시될 것입니다 (예: `echo echoerr echohl echomsg econ`). 다음 옵션으로 이동하려면 `<Tab>` 또는 `Ctrl-N`을 누르세요. 이전 옵션으로 이동하려면 `<Shift-Tab>` 또는 `Ctrl-P`를 누르세요.

일부 커맨드-라인 명령어는 파일 이름을 인수로 받습니다. 한 가지 예는 `edit`입니다. 여기서도 자동 완성을 할 수 있습니다. 명령어 `:e `를 입력한 후(공백을 잊지 마세요), `<Tab>`을 누르세요. Vim은 처음부터 입력할 필요가 없도록 선택할 수 있는 모든 관련 파일 이름을 나열합니다.

## 히스토리 창과 커맨드-라인 창

커맨드-라인 명령어와 검색어의 히스토리를 볼 수 있습니다 (이것은 `+cmdline_hist` 기능이 필요합니다).

커맨드-라인 히스토리를 열려면 `:his :`를 실행하세요. 다음과 같은 것을 볼 수 있습니다:

```
## Cmd history
2  e file1.txt
3  g/foo/d
4  s/foo/bar/g
```

Vim은 실행한 모든 `:` 명령어의 히스토리를 나열합니다. 기본적으로 Vim은 마지막 50개의 명령어를 저장합니다. Vim이 기억하는 항목의 양을 100으로 변경하려면 `set history=100`을 실행하세요.

커맨드-라인 히스토리의 더 유용한 사용법은 커맨드-라인 창 `q:`를 통하는 것입니다. 이것은 검색 가능하고 편집 가능한 히스토리 창을 엽니다. `q:`를 눌렀을 때 히스토리에 다음과 같은 표현식이 있다고 가정해 봅시다:

```
51  s/verylongsubstitutionpattern/pancake/g
52  his :
53  wq
```

현재 작업이 `s/verylongsubstitutionpattern/donut/g`를 하는 것이라면, 명령어를 처음부터 입력하는 대신 `s/verylongsubstitutionpattern/pancake/g`를 재사용하는 것은 어떨까요? 결국, 다른 것은 단어 치환, "donut" 대 "pancake"뿐입니다. 다른 모든 것은 동일합니다.

`q:`를 실행한 후, 히스토리에서 `s/verylongsubstitutionpattern/pancake/g`를 찾아서(이 환경에서는 Vim 탐색을 사용할 수 있음) 직접 편집하세요! 히스토리 창 안에서 "pancake"를 "donut"으로 변경한 다음, `<Enter>`를 누르세요. 붐! Vim이 `s/verylongsubstitutionpattern/donut/g`를 실행해 줍니다. 매우 편리합니다!

마찬가지로, 검색 히스토리를 보려면 `:his /` 또는 `:his ?`를 실행하세요. 과거 히스토리를 검색하고 편집할 수 있는 검색 히스토리 창을 열려면 `q/` 또는 `q?`를 실행하세요.

이 창을 종료하려면 `Ctrl-C`, `Ctrl-W C`, 또는 `:quit`를 입력하세요.

## 더 많은 커맨드-라인 명령어

Vim에는 수백 개의 내장 명령어가 있습니다. Vim이 가진 모든 명령어를 보려면 `:h ex-cmd-index` 또는 `:h :index`를 확인하세요.

## 현명하게 커맨드-라인 모드 배우기

다른 세 가지 모드와 비교할 때, 커맨드-라인 모드는 텍스트 편집의 스위스 아미 나이프와 같습니다. 텍스트를 편집하고, 파일을 수정하고, 명령어를 실행하는 등 몇 가지만 예를 들 수 있습니다. 이 장은 커맨드-라인 모드의 잡다한 것들의 모음입니다. 또한 Vim 모드를 마무리합니다. 이제 일반, 삽입, 비주얼, 그리고 커맨드-라인 모드를 사용하는 방법을 알았으니, 이전보다 더 빠르게 Vim으로 텍스트를 편집할 수 있습니다.

이제 Vim 모드에서 벗어나 Vim 태그로 훨씬 더 빠른 탐색을 하는 방법을 배울 때입니다.