# Ch02. 버퍼, 창, 탭

이전에 최신 텍스트 편집기를 사용해 본 적이 있다면 창과 탭에 익숙할 것입니다. Vim은 두 개가 아닌 세 개의 디스플레이 추상화, 즉 버퍼, 창, 탭을 사용합니다. 이 장에서는 버퍼, 창, 탭이 무엇이며 Vim에서 어떻게 작동하는지 설명하겠습니다.

시작하기 전에, vimrc에 `set hidden` 옵션이 있는지 확인하세요. 이 옵션이 없으면 버퍼를 전환할 때 현재 버퍼가 저장되지 않은 경우 Vim에서 파일을 저장하라는 메시지를 표시합니다(빠르게 이동하고 싶다면 원치 않는 상황입니다). 아직 vimrc에 대해 다루지 않았습니다. vimrc가 없다면 하나 만드세요. 보통 홈 디렉토리에 위치하며 이름은 `.vimrc`입니다. 제 경우에는 `~/.vimrc`에 있습니다. vimrc를 어디에 만들어야 하는지 확인하려면 `:h vimrc`를 확인하세요. 그 안에 다음을 추가하세요:

```
set hidden
```

저장한 다음, 소싱하세요 (vimrc 내부에서 `:source %` 실행).

## 버퍼

*버퍼*란 무엇일까요?

버퍼는 텍스트를 쓰고 편집할 수 있는 메모리 내 공간입니다. Vim에서 파일을 열면 데이터가 버퍼에 바인딩됩니다. Vim에서 3개의 파일을 열면 3개의 버퍼가 생깁니다.

비어있는 두 파일, `file1.js`와 `file2.js`를 준비하세요(가능하다면 Vim으로 만드세요). 터미널에서 다음을 실행하세요:

```bash
vim file1.js
```

지금 보고 있는 것은 `file1.js` *버퍼*입니다. 새 파일을 열 때마다 Vim은 새 버퍼를 만듭니다.

Vim을 종료하세요. 이번에는 두 개의 새 파일을 여세요:

```bash
vim file1.js file2.js
```

Vim은 현재 `file1.js` 버퍼를 표시하고 있지만, 실제로는 `file1.js` 버퍼와 `file2.js` 버퍼, 두 개의 버퍼를 만듭니다. 모든 버퍼를 보려면 `:buffers`를 실행하세요 (또는 `:ls`나 `:files`를 사용할 수도 있습니다). `file1.js`와 `file2.js`가 모두 목록에 표시될 것입니다. `vim file1 file2 file3 ... filen`을 실행하면 n개의 버퍼가 생성됩니다. 새 파일을 열 때마다 Vim은 해당 파일에 대한 새 버퍼를 만듭니다.

버퍼를 탐색하는 방법에는 여러 가지가 있습니다:
- `:bnext`는 다음 버퍼로 이동합니다 (`:bprevious`는 이전 버퍼로 이동).
- `:buffer` + 파일 이름. Vim은 `<Tab>`으로 파일 이름을 자동 완성할 수 있습니다.
- `:buffer` + `n`, 여기서 `n`은 버퍼 번호입니다. 예를 들어, `:buffer 2`를 입력하면 버퍼 #2로 이동합니다.
- 점프 목록에서 `Ctrl-O`로 이전 위치로, `Ctrl-I`로 새로운 위치로 점프합니다. 이것들은 버퍼 특정 방법은 아니지만, 다른 버퍼 간에 점프하는 데 사용할 수 있습니다. 점프에 대해서는 5장에서 더 자세히 설명하겠습니다.
- `Ctrl-^`로 이전에 편집했던 버퍼로 이동합니다.

Vim이 버퍼를 만들면, 그 버퍼는 버퍼 목록에 남아있게 됩니다. 버퍼를 제거하려면 `:bdelete`를 입력할 수 있습니다. 버퍼 번호를 매개변수로 받을 수도 있고(`:bdelete 3`은 버퍼 #3을 삭제), 파일 이름을 받을 수도 있습니다 (`:bdelete` 후 `<Tab>`을 사용하여 자동 완성).

버퍼에 대해 배울 때 가장 어려웠던 점은 버퍼가 어떻게 작동하는지 시각화하는 것이었습니다. 제 마음은 주류 텍스트 편집기를 사용할 때의 창에 익숙해져 있었기 때문입니다. 좋은 비유는 플레잉 카드 덱입니다. 만약 2개의 버퍼가 있다면, 2장의 카드가 쌓여있는 것입니다. 맨 위에 있는 카드만 볼 수 있지만, 그 아래에 카드가 있다는 것을 알고 있습니다. `file1.js` 버퍼가 표시된다면, `file1.js` 카드가 덱의 맨 위에 있는 것입니다. 다른 카드인 `file2.js`는 볼 수 없지만, 거기에 있습니다. `file2.js`로 버퍼를 전환하면, 이제 `file2.js` 카드가 덱의 맨 위에 있고 `file1.js` 카드는 그 아래에 있습니다.

이전에 Vim을 사용해 본 적이 없다면, 이것은 새로운 개념입니다. 시간을 갖고 이해하도록 노력하세요.

## Vim 종료하기

참고로, 여러 버퍼가 열려 있는 경우, 모두 닫기(quit-all)로 모든 버퍼를 닫을 수 있습니다:

```
:qall
```

변경 사항을 저장하지 않고 닫고 싶다면, 끝에 `!`를 추가하면 됩니다:

```
:qall!
```

모두 저장하고 종료하려면 다음을 실행하세요:

```
:wqall
```

## 창

창은 버퍼의 뷰포트입니다. 주류 편집기에서 오셨다면 이 개념에 익숙할 수 있습니다. 대부분의 텍스트 편집기에는 여러 창을 표시하는 기능이 있습니다. Vim에서도 여러 창을 가질 수 있습니다.

터미널에서 다시 `file1.js`를 열어봅시다:

```bash
vim file1.js
```

앞서 `file1.js` 버퍼를 보고 있다고 썼습니다. 그 말은 맞지만, 불완전한 설명이었습니다. 여러분은 **하나의 창**을 통해 `file1.js` 버퍼를 보고 있는 것입니다. 창은 버퍼를 보는 방법입니다.

아직 Vim을 종료하지 마세요. 다음을 실행하세요:

```
:split file2.js
```

이제 **두 개의 창**을 통해 두 개의 버퍼를 보고 있습니다. 위쪽 창에는 `file2.js` 버퍼가 표시됩니다. 아래쪽 창에는 `file1.js` 버퍼가 표시됩니다.

창 사이를 탐색하려면 다음 단축키를 사용하세요:

```
Ctrl-W H    커서를 왼쪽 창으로 이동합니다
Ctrl-W J    커서를 아래쪽 창으로 이동합니다
Ctrl-W K    커서를 위쪽 창으로 이동합니다
Ctrl-W L    커서를 오른쪽 창으로 이동합니다
```

이제 다음을 실행하세요:

```
:vsplit file3.js
```

이제 세 개의 버퍼를 표시하는 세 개의 창을 보고 있습니다. 한 창은 `file3.js` 버퍼를, 다른 창은 `file2.js` 버퍼를, 또 다른 창은 `file1.js` 버퍼를 표시합니다.

동일한 버퍼를 표시하는 여러 창을 가질 수 있습니다. 왼쪽 상단 창에 있는 동안 다음을 입력하세요:

```
:buffer file2.js
```

이제 두 창 모두 `file2.js` 버퍼를 표시하고 있습니다. `file2.js` 창에서 입력을 시작하면 `file2.js` 버퍼를 표시하는 두 창 모두 실시간으로 업데이트되는 것을 볼 수 있습니다.

현재 창을 닫으려면 `Ctrl-W C`를 실행하거나 `:quit`를 입력할 수 있습니다. 창을 닫아도 버퍼는 그대로 남아 있습니다 (`:buffers`를 실행하여 확인하세요).

다음은 유용한 일반 모드 창 명령어입니다:

```
Ctrl-W V    새로운 수직 분할 창을 엽니다
Ctrl-W S    새로운 수평 분할 창을 엽니다
Ctrl-W C    창을 닫습니다
Ctrl-W O    현재 창을 화면의 유일한 창으로 만들고 다른 창을 닫습니다
```

그리고 다음은 유용한 창 커맨드-라인 명령어 목록입니다:

```
:vsplit filename    창을 수직으로 분할합니다
:split filename     창을 수평으로 분할합니다
:new filename       새 창을 만듭니다
```

시간을 갖고 이해하도록 노력하세요. 더 많은 정보는 `:h window`를 확인하세요.

## 탭

탭은 창의 모음입니다. 창의 레이아웃과 같다고 생각하면 됩니다. 대부분의 최신 텍스트 편집기(그리고 최신 인터넷 브라우저)에서 탭은 열린 파일/페이지를 의미하며, 탭을 닫으면 해당 파일/페이지가 사라집니다. Vim에서 탭은 열린 파일을 나타내지 않습니다. Vim에서 탭을 닫는 것은 파일을 닫는 것이 아닙니다. 레이아웃만 닫는 것입니다. 해당 레이아웃에서 열었던 파일들은 여전히 닫히지 않았고, 버퍼에 열려 있습니다.

Vim 탭을 실제로 사용해 봅시다. `file1.js`를 여세요:

```bash
vim file1.js
```

새 탭에서 `file2.js`를 열려면:

```
:tabnew file2.js
```

`<Tab>`을 눌러 *새 탭*에서 열고 싶은 파일을 Vim이 자동 완성하도록 할 수도 있습니다 (말장난이 아닙니다).

다음은 유용한 탭 탐색 목록입니다:

```
:tabnew file.txt    새 탭에서 file.txt를 엽니다
:tabclose           현재 탭을 닫습니다
:tabnext            다음 탭으로 이동합니다
:tabprevious        이전 탭으로 이동합니다
:tablast            마지막 탭으로 이동합니다
:tabfirst           첫 탭으로 이동합니다
```

`gt`를 실행하여 다음 탭 페이지로 이동할 수도 있습니다 (`gT`로 이전 탭으로 이동할 수 있습니다). `gt`에 횟수를 인자로 전달할 수 있으며, 횟수는 탭 번호입니다. 세 번째 탭으로 이동하려면 `3gt`를 하세요.

여러 탭을 사용하는 한 가지 장점은 다른 탭에서 다른 창 배열을 가질 수 있다는 것입니다. 첫 번째 탭에는 3개의 수직 창을, 두 번째 탭에는 수평 및 수직 창이 혼합된 레이아웃을 원할 수 있습니다. 탭은 이 작업에 완벽한 도구입니다!

여러 탭으로 Vim을 시작하려면 터미널에서 다음을 수행할 수 있습니다:

```bash
vim -p file1.js file2.js file3.js
```

## 3D로 이동하기

창 사이를 이동하는 것은 데카르트 좌표계에서 X-Y 축을 따라 2차원적으로 이동하는 것과 같습니다. `Ctrl-W H/J/K/L`로 상, 우, 하, 좌 창으로 이동할 수 있습니다.

버퍼 사이를 이동하는 것은 데카르트 좌표계에서 Z 축을 가로질러 이동하는 것과 같습니다. 버퍼 파일들이 Z 축을 따라 줄지어 있다고 상상해보세요. `:bnext`와 `:bprevious`로 한 번에 하나의 버퍼씩 Z 축을 탐색할 수 있습니다. `:buffer filename/buffernumber`로 Z 축의 어느 좌표로든 점프할 수 있습니다.

창과 버퍼 이동을 결합하여 *3차원 공간*에서 이동할 수 있습니다. 창 이동으로 상, 우, 하, 좌 창으로 이동할 수 있습니다 (X-Y 탐색). 각 창에는 버퍼가 포함되어 있으므로, 버퍼 이동으로 앞뒤로 이동할 수 있습니다 (Z 탐색).

## 버퍼, 창, 탭을 현명하게 사용하기

버퍼, 창, 탭이 무엇이며 Vim에서 어떻게 작동하는지 배웠습니다. 이제 그것들을 더 잘 이해했으므로, 자신만의 작업 흐름에 사용할 수 있습니다.

모든 사람은 다른 작업 흐름을 가지고 있습니다. 예를 들어 제 작업 흐름은 다음과 같습니다:
- 먼저, 현재 작업에 필요한 모든 파일을 저장하기 위해 버퍼를 사용합니다. Vim은 느려지기 시작하기 전에 많은 열린 버퍼를 처리할 수 있습니다. 또한 많은 버퍼를 열어도 화면이 복잡해지지 않습니다. 언제든지 하나의 버퍼만 보고 있으므로(창이 하나만 있다고 가정하면), 한 화면에 집중할 수 있습니다. 어딘가로 가야 할 때, 언제든지 열려 있는 버퍼로 빠르게 이동할 수 있습니다.
- 여러 버퍼를 한 번에 보기 위해 여러 창을 사용합니다. 주로 파일을 비교하거나, 문서를 읽거나, 코드 흐름을 따라갈 때 사용합니다. 화면이 복잡해지기 때문에(작은 노트북을 사용합니다) 열려 있는 창의 수를 3개 이하로 유지하려고 노력합니다. 작업이 끝나면 추가 창을 닫습니다. 창이 적을수록 방해 요소가 줄어듭니다.
- 탭 대신 [tmux](https://github.com/tmux/tmux/wiki) 창을 사용합니다. 보통 한 번에 여러 개의 tmux 창을 사용합니다. 예를 들어, 클라이언트 측 코드를 위한 tmux 창 하나와 백엔드 코드를 위한 다른 창 하나를 사용합니다.

제 작업 흐름은 여러분의 편집 스타일에 따라 다를 수 있으며 괜찮습니다. 자신만의 코딩 스타일에 맞는 흐름을 발견하기 위해 실험해보세요.