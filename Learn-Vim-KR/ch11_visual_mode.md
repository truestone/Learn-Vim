# Ch11. 비주얼 모드

텍스트 본문을 강조 표시하고 변경 사항을 적용하는 것은 많은 텍스트 편집기와 워드 프로세서의 일반적인 기능입니다. Vim은 비주얼 모드를 사용하여 이 작업을 수행할 수 있습니다. 이 장에서는 비주얼 모드를 사용하여 텍스트를 효율적으로 조작하는 방법을 배웁니다.

## 세 가지 유형의 비주얼 모드

Vim에는 세 가지 다른 비주얼 모드가 있습니다. 그것들은 다음과 같습니다:

```
v         문자 단위 비주얼 모드
V         줄 단위 비주얼 모드
Ctrl-V    블록 단위 비주얼 모드
```

다음과 같은 텍스트가 있다면:

```
one
two
three
```

문자 단위 비주얼 모드는 개별 문자와 함께 작동합니다. 첫 번째 문자에서 `v`를 누릅니다. 그런 다음 `j`로 다음 줄로 내려갑니다. "one"에서 커서 위치까지의 모든 텍스트를 강조 표시합니다. `gU`를 누르면 Vim은 강조 표시된 문자를 대문자로 만듭니다.

줄 단위 비주얼 모드는 줄과 함께 작동합니다. `V`를 누르고 Vim이 커서가 있는 전체 줄을 선택하는 것을 지켜보세요. 문자 단위 비주얼 모드와 마찬가지로 `gU`를 실행하면 Vim은 강조 표시된 문자를 대문자로 만듭니다.

블록 단위 비주얼 모드는 행과 열과 함께 작동합니다. 다른 두 모드보다 더 많은 이동의 자유를 제공합니다. `Ctrl-V`를 누르면 Vim은 문자 단위 비주얼 모드처럼 커서 아래의 문자를 강조 표시하지만, 다음 줄로 내려가기 전에 줄 끝까지 각 문자를 강조 표시하는 대신 최소한의 강조 표시로 다음 줄로 이동합니다. `h/j/k/l`로 이동하며 커서가 움직이는 것을 지켜보세요.

Vim 창의 왼쪽 하단에 `-- VISUAL --`, `-- VISUAL LINE --`, 또는 `-- VISUAL BLOCK --` 중 하나가 표시되어 어떤 비주얼 모드에 있는지 나타냅니다.

비주얼 모드 안에 있는 동안, `v`, `V`, 또는 `Ctrl-V`를 눌러 다른 비주얼 모드로 전환할 수 있습니다. 예를 들어, 줄 단위 비주얼 모드에 있고 블록 단위 비주얼 모드로 전환하고 싶다면, `Ctrl-V`를 실행하세요. 시도해보세요!

비주얼 모드를 종료하는 방법에는 세 가지가 있습니다: `<Esc>`, `Ctrl-C`, 그리고 현재 비주얼 모드와 같은 키입니다. 후자가 의미하는 것은 현재 줄 단위 비주얼 모드(`V`)에 있다면, `V`를 다시 눌러 종료할 수 있다는 것입니다. 문자 단위 비주얼 모드에 있다면, `v`를 눌러 종료할 수 있습니다.

실제로 비주얼 모드로 들어가는 방법이 하나 더 있습니다:

```
gv    이전 비주얼 모드로 이동
```

지난번에 했던 것과 동일한 강조 표시된 텍스트 블록에서 동일한 비주얼 모드를 시작합니다.

## 비주얼 모드 탐색

비주얼 모드에 있는 동안 Vim 모션으로 강조 표시된 텍스트 블록을 확장할 수 있습니다.

이전에 사용했던 동일한 텍스트를 사용해 봅시다:

```
one
two
three
```

이번에는 "two" 줄에서 시작해 봅시다. `v`를 눌러 문자 단위 비주얼 모드로 들어갑니다 (여기서 대괄호 `[]`는 문자 강조 표시를 나타냅니다):

```
one
[t]wo
three
```

`j`를 누르면 Vim은 "two" 줄에서 "three" 줄의 첫 문자까지의 모든 텍스트를 강조 표시합니다.

```
one
[two
t]hree
```

이 위치에서 "one" 줄도 추가하고 싶다고 가정해 봅시다. `k`를 누르면, 실망스럽게도 강조 표시가 "three" 줄에서 멀어집니다.

```
one
[t]wo
three
```

원하는 방향으로 자유롭게 비주얼 선택을 확장할 방법이 있을까요? 물론입니다. "two"와 "three" 줄이 강조 표시된 곳으로 조금 돌아가 봅시다.

```
one
[two
t]hree    <-- 커서
```

비주얼 강조 표시는 커서 이동을 따릅니다. "one" 줄까지 위로 확장하고 싶다면, 커서를 "two" 줄까지 위로 이동해야 합니다. 지금 커서는 "three" 줄에 있습니다. `o` 또는 `O`로 커서 위치를 전환할 수 있습니다.

```
one
[two     <-- 커서
t]hree
```

이제 `k`를 누르면 더 이상 선택이 줄어들지 않고 위로 확장됩니다.

```
[one
two
t]hree
```

비주얼 모드에서 `o` 또는 `O`를 사용하면 커서가 강조 표시된 블록의 시작에서 끝으로 점프하여 강조 영역을 확장할 수 있습니다.

## 비주얼 모드 문법

비주얼 모드는 일반 모드와 많은 작업을 공유합니다.

예를 들어, 다음 텍스트가 있고 비주얼 모드에서 처음 두 줄을 삭제하고 싶다면:

```
one
two
three
```

줄 단위 비주얼 모드(`V`)로 "one"과 "two" 줄을 강조 표시합니다:

```
[one
two]
three
```

`d`를 누르면 일반 모드와 유사하게 선택 항목이 삭제됩니다. 일반 모드의 문법 규칙인 동사 + 명사가 적용되지 않는다는 점에 유의하세요. 동일한 동사(`d`)는 여전히 있지만, 비주얼 모드에는 명사가 없습니다. 비주얼 모드의 문법 규칙은 명사 + 동사이며, 여기서 명사는 강조 표시된 텍스트입니다. 먼저 텍스트 블록을 선택한 다음 명령어가 따릅니다.

일반 모드에서는 커서 아래의 단일 문자를 삭제하는 `x`나 커서 아래의 문자를 바꾸는 `r`(`rx`는 커서 아래의 문자를 "x"로 바꿈)과 같이 모션이 필요 없는 일부 명령어가 있습니다. 비주얼 모드에서는 이러한 명령어가 이제 단일 문자가 아닌 전체 강조 표시된 텍스트에 적용됩니다. 강조 표시된 텍스트로 돌아가서:

```
[one
two]
three
```

`x`를 실행하면 모든 강조 표시된 텍스트가 삭제됩니다.

이 동작을 사용하여 마크다운 텍스트에서 헤더를 빠르게 만들 수 있습니다. 다음 텍스트를 1단계 마크다운 헤더("===")로 빠르게 바꿔야 한다고 가정해 봅시다:

```
Chapter One
```

먼저 `yy`로 텍스트를 복사한 다음 `p`로 붙여넣습니다:

```
Chapter One
Chapter One
```

이제 두 번째 줄로 가서 줄 단위 비주얼 모드로 선택합니다:

```
Chapter One
[Chapter One]
```

1단계 헤더는 텍스트 아래에 일련의 "="입니다. `r=`을 실행하면, 짜잔! 이것은 "="를 수동으로 입력하는 것을 절약해줍니다.

```
Chapter One
===========
```

비주얼 모드의 연산자에 대해 더 배우려면 `:h visual-operators`를 확인하세요.

## 비주얼 모드와 커맨드-라인 명령어

강조 표시된 텍스트 블록에 선택적으로 커맨드-라인 명령어를 적용할 수 있습니다. 이러한 문장이 있고 처음 두 줄에서만 "const"를 "let"으로 바꾸고 싶다면:

```
const one = "one";
const two = "two";
const three = "three";
```

*어떤* 비주얼 모드로든 처음 두 줄을 강조 표시하고 대체 명령어 `:s/const/let/g`를 실행합니다:

```
let one = "one";
let two = "two";
const three = "three";
```

*어떤* 비주얼 모드로든 이 작업을 수행할 수 있다고 말한 것에 주목하세요. 해당 줄에서 명령어를 실행하기 위해 전체 줄을 강조 표시할 필요는 없습니다. 각 줄에서 적어도 하나의 문자를 선택하면 명령어가 적용됩니다.

## 여러 줄에 텍스트 추가하기

블록 단위 비주얼 모드를 사용하여 Vim에서 여러 줄에 텍스트를 추가할 수 있습니다. 각 줄의 끝에 세미콜론을 추가해야 한다면:

```
const one = "one"
const two = "two"
const three = "three"
```

첫 번째 줄에 커서를 놓고:
- 블록 단위 비주얼 모드를 실행하고 두 줄 아래로 이동합니다(`Ctrl-V jj`).
- 줄 끝까지 강조 표시합니다(`$`).
- 추가(`A`)한 다음 ";"를 입력합니다.
- 비주얼 모드를 종료합니다(`<Esc>`).

이제 각 줄에 추가된 ";"를 볼 수 있습니다. 꽤 멋지죠! 블록 단위 비주얼 모드에서 삽입 모드로 들어가는 방법에는 두 가지가 있습니다: 커서 뒤에 텍스트를 입력하는 `A` 또는 커서 앞에 텍스트를 입력하는 `I`입니다. 일반 모드의 `A`(줄 끝에 텍스트 추가) 및 `I`(공백이 아닌 첫 줄 앞에 텍스트 삽입)와 혼동하지 마세요.

또는 `:normal` 명령어를 사용하여 여러 줄에 텍스트를 추가할 수도 있습니다:
- 모든 3줄을 강조 표시합니다(`vjj`).
- `:normal! A;`를 입력합니다.

`:normal` 명령어는 일반 모드 명령어를 실행한다는 것을 기억하세요. 줄 끝에 텍스트 ";"를 추가하도록 `A;`를 실행하도록 지시할 수 있습니다.

## 숫자 증가시키기

Vim에는 숫자를 감소 및 증가시키는 `Ctrl-X` 및 `Ctrl-A` 명령어가 있습니다. 비주얼 모드와 함께 사용하면 여러 줄에 걸쳐 숫자를 증가시킬 수 있습니다.

다음과 같은 HTML 요소가 있다면:

```
<div id="app-1"></div>
<div id="app-1"></div>
<div id="app-1"></div>
<div id="app-1"></div>
<div id="app-1"></div>
```

여러 ID가 같은 이름을 갖는 것은 나쁜 습관이므로, 고유하게 만들기 위해 증가시켜 봅시다:
- 두 번째 줄의 "1"로 커서를 이동합니다.
- 블록 단위 비주얼 모드를 시작하고 3줄 아래로 이동합니다(`Ctrl-V 3j`). 이렇게 하면 나머지 "1"이 강조 표시됩니다. 이제 첫 번째 줄을 제외한 모든 "1"이 강조 표시되어야 합니다.
- `g Ctrl-A`를 실행합니다.

다음 결과를 볼 수 있습니다:

```
<div id="app-1"></div>
<div id="app-2"></div>
<div id="app-3"></div>
<div id="app-4"></div>
<div id="app-5"></div>
```

`g Ctrl-A`는 여러 줄의 숫자를 증가시킵니다. `Ctrl-X`/`Ctrl-A`는 숫자 형식 옵션을 사용하여 문자도 증가시킬 수 있습니다:

```
set nrformats+=alpha
```

`nrformats` 옵션은 `Ctrl-A` 및 `Ctrl-X`가 증가 및 감소시킬 "숫자"로 간주할 기준을 Vim에 지시합니다. `alpha`를 추가함으로써 알파벳 문자는 이제 숫자로 간주됩니다. 다음과 같은 HTML 요소가 있다면:

```
<div id="app-a"></div>
<div id="app-a"></div>
<div id="app-a"></div>
<div id="app-a"></div>
<div id="app-a"></div>
```

두 번째 "app-a"에 커서를 놓습니다. 위와 동일한 기술(`Ctrl-V 3j` 다음 `g Ctrl-A`)을 사용하여 ID를 증가시킵니다.

```
<div id="app-a"></div>
<div id="app-b"></div>
<div id="app-c"></div>
<div id="app-d"></div>
<div id="app-e"></div>
```

## 마지막 비주얼 모드 영역 선택하기

이 장 앞부분에서 `gv`가 마지막 비주얼 모드 강조 표시를 빠르게 강조할 수 있다고 언급했습니다. 다음 두 특수 마크로 마지막 비주얼 모드의 시작과 끝 위치로 이동할 수도 있습니다:

```
`<    이전 비주얼 모드 강조 표시의 첫 번째 위치로 이동
`>    이전 비주얼 모드 강조 표시의 마지막 위치로 이동
```

앞서, 강조 표시된 텍스트에 선택적으로 커맨드-라인 명령어 `:s/const/let/g`를 실행할 수 있다고 언급했습니다. 그렇게 했을 때, 아래와 같은 것을 볼 수 있었을 것입니다:

```
:`<,`>s/const/let/g
```

실제로는 *범위가 지정된* `s/const/let/g` 명령어를 실행하고 있었습니다 (두 마크가 주소임). 흥미롭네요!

원하는 언제든지 이 마크들을 편집할 수 있습니다. 강조 표시된 텍스트의 시작부터 파일 끝까지 대체해야 했다면, 명령어를 다음과 같이 변경하면 됩니다:

```
:`<,$s/const/let/g
```

## 삽입 모드에서 비주얼 모드로 들어가기

삽입 모드에서 비주얼 모드로 들어갈 수도 있습니다. 삽입 모드에 있는 동안 문자 단위 비주얼 모드로 이동하려면:

```
Ctrl-O v
```

삽입 모드에 있는 동안 `Ctrl-O`를 실행하면 일반 모드 명령어를 실행할 수 있다는 것을 상기하세요. 이 일반 모드 명령어 대기 모드에 있는 동안, `v`를 실행하여 문자 단위 비주얼 모드로 들어갑니다. 화면 왼쪽 하단에 `--(insert) VISUAL--`이라고 표시되는 것을 확인하세요. 이 트릭은 모든 비주얼 모드 연산자 `v`, `V`, `Ctrl-V`에서 작동합니다.

## 선택 모드

Vim에는 선택 모드라는 비주얼 모드와 유사한 모드가 있습니다. 비주얼 모드와 마찬가지로 세 가지 다른 모드가 있습니다:

```
gh         문자 단위 선택 모드
gH         줄 단위 선택 모드
gCtrl-h    블록 단위 선택 모드
```

선택 모드는 Vim의 비주얼 모드보다 일반 편집기의 텍스트 강조 표시 동작을 더 가깝게 모방합니다.

일반 편집기에서 텍스트 블록을 강조 표시하고 문자, 예를 들어 "y"를 입력하면, 강조 표시된 텍스트가 삭제되고 문자 "y"가 삽입됩니다. 줄 단위 선택 모드(`gH`)로 한 줄을 강조 표시하고 "y"를 입력하면, 강조 표시된 텍스트가 삭제되고 문자 "y"가 삽입됩니다.

이 선택 모드를 비주얼 모드와 대조해 보세요: 줄 단위 비주얼 모드(`V`)로 텍스트 한 줄을 강조 표시하고 "y"를 입력하면, 강조 표시된 텍스트는 삭제되고 문자 "y"로 대체되지 않고, 복사됩니다. 선택 모드에서는 강조 표시된 텍스트에 일반 모드 명령어를 실행할 수 없습니다.

저는 개인적으로 선택 모드를 사용해 본 적이 없지만, 존재한다는 것을 아는 것은 좋습니다.

## 현명하게 비주얼 모드 배우기

비주얼 모드는 Vim의 텍스트 강조 표시 절차의 표현입니다.

일반 모드 작업보다 비주얼 모드 작업을 훨씬 더 자주 사용한다면, 조심하세요. 이것은 안티-패턴입니다. 비주얼 모드 작업을 실행하는 데는 일반 모드 상대보다 더 많은 키 입력이 필요합니다. 예를 들어, 내부 단어를 삭제해야 한다면, 세 번의 키 입력(`diw`)으로 달성할 수 있는데 왜 네 번의 키 입력(`viwd`, 시각적으로 내부 단어를 강조 표시한 다음 삭제)을 사용해야 할까요? 후자가 더 직접적이고 간결합니다. 물론, 비주얼 모드가 적절할 때도 있겠지만, 일반적으로 더 직접적인 접근 방식을 선호하세요.